import {
- core.bool
}

use {
- this.nat-fact::nat
}

variant nat {
- Zero
- Succ(nat)
}

define add-nat(x: nat, y: nat): nat {
  match x {
  - Zero =>
    y
  - Succ(m) =>
    add-nat(m, Succ(y))
  }
}

define mul-nat(x: nat, y: nat): nat {
  match x {
  - Zero =>
    Zero
  - Succ(m) =>
    add-nat(mul-nat(m, y), y)
  }
}

define eq-nat(n1: nat, n2: nat): core.bool::bool() {
  match n1, n2 {
  - Zero, Zero =>
    core.bool::bool.True()
  - Succ(m1), Succ(m2) =>
    eq-nat(m1, m2)
  - n1, n2 =>
    core.bool::bool.False()
  }
}

define fact(n: nat): nat {
  match n {
  - Zero =>
    Succ(Zero)
  - Succ(m) =>
    mul-nat(n, fact(m))
  }
}

define interpret(n: nat): i64 {
  match n {
  - nat.Zero =>
    0
  - nat.Succ(m) =>
    add-i64(1, interpret(m))
  }
}

define main(): i64 {
  let n5 = Succ(Succ(Succ(Succ(Succ(Zero)))))
  interpret(fact(n5))
}
