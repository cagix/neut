import {
- core.bool
- core.list => L
- core.text => T
}

data stream-cell(a) {
- Nil
- Cons(a, stream(a))
}

inline stream(a: tau): tau {
  () -> stream-cell(a)
}

define append(a: tau, xs: stream(a), ys: stream(a)): stream(a) {
  match xs() {
  - Nil =>
    ys
  - Cons(x1, rest) =>
    () => {
      Cons(x1, append(a, rest, ys))
    }
  }
}

define take(a: tau, n: int, xs: stream(a)): stream(a) {
  if eq-int(n, 0) {
    () => { Nil }
  } else {
    match xs() {
    - Nil =>
      () => { Nil }
    - Cons(x, rest) =>
      () => {
        Cons(x, take(a, sub-int(n, 1), rest))
      }
    }
  }
}

define main(): unit {
  let my-stream: stream(int) =
    () => { Cons(1, () => { Nil }) }
  in
  let _ = my-stream in
  Unit
}
