import {
- core.list
- core.text
}

data custom-stack(a) {
- Nil
- Cons(tuple(a, a), custom-stack(a))
}

define empty(a: tau): custom-stack(a) {
  Nil
}

define is-empty(a: tau, xs: &custom-stack(a)): bool {
  case xs {
  - Nil =>
    True
  - Cons(_, _) =>
    False
  }
}

define head(a: tau, xs: &custom-stack(a)): ?&tuple(a, a) {
  case xs {
  - Nil =>
    None
  - Cons(a, _) =>
    Some(a)
  }
}

define tail(a: tau, xs: &custom-stack(a)): ?&custom-stack(a) {
  case xs {
  - Nil =>
    None
  - Cons(_, rest) =>
    Some(rest)
  }
}

define main(): unit {
  let xs = empty(_) in
  let v = Tuple(() => { 1 }, () => { 2: int }) in
  let ys = Cons(v, xs) in
  let zs = Cons(v, Cons(v, ys)) in
  let calc on zs, xs =
    let _ = is-empty(_, zs) in
    let _ = is-empty(_, xs) in
    let h = head(_, zs) in
    let _ = head(_, xs) in
    let _ = tail(_, zs) in
    let _ = tail(_, zs) in
    match h {
    - None =>
      1
    - Some(pair) =>
      tie Tuple(_, right) = pair in
      {*right}()
    }
  in
  let _ = zs in
  let _ = xs in
  print-int(calc);
  print("\n")
}
